<section
  *ngIf="step === 1"
  class="flex flex-col gap-4 p-5 border-b border-zinc-200 dark:border-zinc-700"
>
  <header class="flex gap-4 items-center text-gray-500 dark:text-gray-200">
    <a
      [routerLink]="['/bookings']"
      class="w-10 h-10 aspect-square bg-zinc-100 dark:bg-zinc-900 grid place-items-center rounded-full"
    >
      <i class="material-icons-outlined !text-md">arrow_back_ios_new</i>
    </a>
    <h1 class="saira-font text-xl">Escolha um serviço para continuar</h1>
  </header>

  <section class="flex flex-col mx-2 rounded-xl">
    <all-services [onAction]="selectItem" [isActive]="isActive"></all-services>
  </section>
</section>

<section
  *ngIf="step === 2"
  class="flex flex-col gap-4 p-5 border-b border-zinc-200 dark:border-zinc-700"
>
  <header class="flex gap-4 items-center text-gray-500 dark:text-gray-200">
    <a
      [routerLink]="['/bookings']"
      class="w-10 h-10 aspect-square bg-zinc-100 dark:bg-zinc-900 grid place-items-center rounded-full"
    >
      <i class="material-icons-outlined !text-md">arrow_back_ios_new</i>
    </a>

    <h1 class="saira-font text-xl">Selecione a hora</h1>
  </header>

  <div class="grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6">
    @for (item of selectedServices; track $index) {
    <div
      class="h-[6rem] flex bg-white dark:text-gray-200 flex-1 shadow-zinc-400/10 border-zinc-200 text-zinc-600 dark:border-zinc-800 shadow-lg dark:shadow-black gap-3 dark:bg-zinc-900 overflow-hidden border rounded-2xl"
    >
      <div
        class="p-2 aspect-square bg-gradient-to-br from-indigo-50 to-violet-50/80 dark:from-zinc-950/20 dark:to-indigo-500/10 relative border-zinc-200 rounded-t-xl overflow-hidden dark:border-zinc-800 border-b grid place-items-center"
      >
        <img
          *ngIf="item.photoUrl"
          [ngSrc]="item.photoUrl"
          alt="Foto do Serviço"
          priority
          fill
          class="absolute h-full w-full object-cover z-10 opacity-70 group-hover:opacity-40 dark:opacity-60 dark:group-hover:opacity-30 transition-opacity"
        />

        <div
          *ngIf="!item.photoUrl"
          class="text-gray-600 dark:text-indigo-200 capitalize saira-font text-[3rem] font-semibold"
        >
          {{item?.title?.[0] || null}}
        </div>
      </div>
      <div class="flex flex-col flex-1 p-1 py-2">
        <h1 class="font-semibold flex-1 text-xl">
          {{ item.title }}
        </h1>

        <div class="justify-between items-center flex">
          <div class="text-xs p-px px-2 rounded-full text-indigo-50 bg-indigo-500">
            {{ item.price | toFormatBrl }}
          </div>

          <div class="pr-2">{{ timeStart }} {{ timeEnd ? `- ${timeEnd}` : "" }}</div>
        </div>
      </div>
    </div>
    }
  </div>
  <div class="flex flex-col gap-2 dark:text-gray-200">
    <label for="bookingTitle" class="text-sm font-medium text-gray-600 dark:text-gray-300">
      Título do agendamento (opcional)
    </label>
    <input
      type="text"
      id="bookingTitle"
      placeholder="Ex: Corte para festa"
      class="w-full p-3 bg-zinc-100 dark:bg-zinc-900 dark:placeholder:text-gray-500 border border-zinc-200 dark:border-zinc-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all"
    />
  </div>

  @if (serviceIds) {
  <section class="flex flex-col rounded-xl">
    <all-times
      [selectedTime]="selectedTime"
      [whenSelectAction]="selectTime"
      [serviceIds]="serviceIds"
      [currentDate]="currentDate?.format('YYYY-MM-DD')"
    ></all-times>
  </section>
  }@else {
  <section>Você não selecionou o serviço</section>
  }
</section>

<footer class="flex px-2 justify-between mt-2">
  <div></div>
  <button
    (click)="submit()"
    [attr.data-active]="!!buttonActive"
    class="bg-indigo-500 text-indigo-50 rounded-full transition-all p-2 px-6 data-[active=false]:opacity-40"
  >
    <span class="saira-font"> Continuar </span>
  </button>
</footer>
