<div class="mx-auto max-w-3xl my-10 px-5">
  <header class="mb-8 flex gap-5">
    <a
      [routerLink]="['/payroll']"
      class="flex w-10 h-10 dark:bg-zinc-800 bg-white rounded-full items-center text-white justify-center"
      ><i class="material-symbols-outlined dark:text-white !text-lg">chevron_backward</i></a
    >
    <div class="flex flex-col gap-1">
      <h1 class="text-2xl font-bold tracking-tight text-zinc-900 dark:text-white sm:text-4xl">
        Revisão da Folha de Pagamento
      </h1>
      <p class="mt-2 text-lg text-zinc-600 dark:text-zinc-400">
        Confira todos os agendamentos e comissões incluídos neste pagamento.
      </p>
    </div>
  </header>

  @if (isLoading()) {
    <div
      class="flex items-center justify-center rounded-xl border border-zinc-200/80 bg-white p-12 dark:border-zinc-800 dark:bg-zinc-900/50"
    >
      <i class="material-symbols-outlined animate-spin text-4xl text-indigo-500">
        progress_activity
      </i>
    </div>
  } @else {
    <div class="space-y-6">
      @for (group of groupedBookings(); track group.day) {
        <div
          class="rounded-xl border border-zinc-200/80 bg-white dark:border-zinc-800 dark:bg-zinc-900/50 overflow-hidden"
        >
          <header
            class="flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-800/50 border-b border-zinc-200/80 dark:border-zinc-800"
          >
            <p class="text-sm font-semibold capitalize text-indigo-600 dark:text-indigo-400">
              {{ group.day }}
            </p>
            <div class="flex items-baseline gap-2">
              <span class="text-xs font-medium text-zinc-500 dark:text-zinc-400"
                >Total do Dia:</span
              >
              <span class="text-lg font-bold text-zinc-900 dark:text-zinc-100">
                {{ group.dayTotalCommission | currency: 'BRL' }}
              </span>
            </div>
          </header>

          <ul class="divide-y divide-zinc-100 dark:divide-zinc-800">
            @for (booking of group.bookings; track booking.id) {
              <li
                (click)="openBookingDetails(booking)"
                class="flex items-center justify-between p-4 transition-colors duration-150 ease-in-out hover:bg-zinc-100 dark:hover:bg-zinc-800/50 cursor-pointer"
              >
                <div class="flex items-center gap-4">
                  <span class="w-12 text-left font-mono text-sm text-zinc-500 dark:text-zinc-400">
                    {{ booking.startAt | date: 'HH:mm' }}
                  </span>
                  <span class="text-sm font-medium text-zinc-800 dark:text-zinc-200">
                    {{ booking.title }}
                  </span>
                </div>
                <div class="flex items-center gap-3">
                  <span class="text-sm font-medium text-green-600 dark:text-green-500">
                    + {{ booking.commissionAmount | currency: 'BRL' }}
                  </span>
                  <i class="material-symbols-outlined text-zinc-400">chevron_right</i>
                </div>
              </li>
            }
          </ul>
        </div>
      } @empty {
        <div
          class="flex flex-col items-center justify-center p-12 text-center rounded-xl border border-zinc-200/80 bg-white dark:border-zinc-800 dark:bg-zinc-900/50"
        >
          <div
            class="flex h-16 w-16 items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-800"
          >
            <i class="material-symbols-outlined text-3xl text-zinc-500">folder_off</i>
          </div>
          <h3 class="mt-4 text-xl font-semibold text-zinc-900 dark:text-white">
            Nenhum Agendamento Encontrado
          </h3>
          <p class="mt-1 text-zinc-500 dark:text-zinc-400">
            Não há agendamentos vinculados a esta folha de pagamento.
          </p>
        </div>
      }
    </div>
  }
</div>
